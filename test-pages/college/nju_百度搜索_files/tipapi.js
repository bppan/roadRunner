/*! tipapi.js 2013-06-24 */
define("ecom/common/api/tip0624/control",[],function(){var t=baidu,e=t.event;t.dom.getAncestorByClass=t.dom.getAncestorByClass||function(t,e){for(t=baidu.dom.g(t),e=RegExp("(^|\\s)"+baidu.string.trim(e)+"(\\s|$)");(t=t.parentNode)&&1===t.nodeType;)if(e.test(t.className))return t;return null};var i=e._eventFilter=e._eventFilter||{};i._crossElementBoundary=i._crossElementBoundary||function(t,e){var i=e.relatedTarget,n=e.currentTarget;return i===!1||n===i||i&&("xul"===i.prefix||baidu.dom.contains(n,i))?void 0:t.call(n,e)},t.fn.bind=t.fn.bind||function(t,e){var i=arguments.length>2?[].slice.call(arguments,2):null;return function(){var n=baidu.lang.isString(t)?e[t]:t,r=i?i.concat([].slice.call(arguments,0)):arguments;return n.apply(e||n,r)}},i.mouseenter=window.attachEvent?null:i.mouseenter||function(t,e,n){return{type:"mouseover",listener:baidu.fn.bind(i._crossElementBoundary,this,n)}},i.mouseleave=window.attachEvent?null:i.mouseleave||function(t,i,n){return{type:"mouseout",listener:baidu.fn.bind(e._eventFilter._crossElementBoundary,this,n)}},t.page.getScrollLeft=t.page.getScrollLeft||function(){var t=document;return window.pageXOffset||t.documentElement.scrollLeft||t.body.scrollLeft};var n=function(t,e){for(var i=-1,n=0,r=t.length;r>n;n++)if(t[n]===e){i=n;break}return i};t.array.indexOf||(t.array.indexOf=n);var r=function(){this.children=[],this._listners={},this.fire("beforeinit"),this.bindEvents(this.binds),this.init.apply(this,arguments),this.fire("afterinit")};return r.prototype={constructor:r,type:"Control",disabled:!1,setOptions:function(e){if(!e)return this.options;var i=t.object,n=this.options=i.clone(this.options),r=/^on[A-Z]/,s=this,o=i.extend;return this.srcOptions=e,i.each(e,function(t,l){if(r.test(l)&&"function"==typeof t){var a=l.charAt(2).toLowerCase()+l.substr(3);s.on(a,t),delete e[l]}else l in n&&(n[l]=i.isPlain(t)?o(n[l]||{},t):t)}),n},bindEvents:function(e){var i=this;e&&e.length&&("string"==typeof e&&(e=e.split(/\s*,\s*/)),t.each(e,function(t,e){e=t&&i[t],e&&(i[t]=function(){return e.apply(i,arguments)})}))},init:function(){throw Error("not implement init")},render:function(){throw Error("not implement render")},appendTo:function(t){this.main=t||this.main,this.render()},disable:function(){this.disabled=!0,this.fireEvent("disable")},enable:function(){this.disabled=!1,this.fireEvent("enable")},isDisabled:function(){return this.disabled},addChild:function(t,e){var i=this.children;e=e||t.childName,e&&(i[nane]=t),i.push(t)},removeChild:function(e){t.object.each(this.children,function(t,i){t===e&&delete this[i]})},getChild:function(t){return this.children[t]},initChildren:function(){throw Error("not implement initChildren")},on:function(e,i){t.isString(e)||(i=e,e="*");var r=this._listners[e]||[];return 0>n(r,i)&&(i.$type=e,r.push(i)),this._listners[e]=r,this},un:function(e,i){t.isString(e)||(i=e,e="*");var r=this._listners[e];if(r)if(i){var s=n(r,i);~s&&delete r[s]}else r.length=0,delete this._listners[e];return this},fire:function(e,i){var n=this._listners[e];return n&&t.array.each(n,function(t){i=i||{},i.type=e,t.call(this,i)},this),"*"!==e&&this.fire("*",i),this},dispose:function(){this.fire("dispose");for(var t;t=this.children.pop();)t.dispose();for(var e in this._listners)this.un(e)}},r}),define("ecom/common/api/tip0624/tip",["require","./control"],function(t){var e=baidu,i=e.dom,n=e.page,r=t("./control"),s=function(t,n){var r=e.event.getTarget(t);return i.hasClass(r,n)||(r=i.getAncestorByClass(r,n))?r:null},o=function(){this.constructor.superClass.constructor.apply(this,arguments)};return o.HIDE_DELAY=500,o.prototype={type:"Tip",options:{disabled:!1,main:"",arrow:!1,hideDelay:0,mode:"over",title:null,content:"",prefix:"ecl-ui-tip",triggers:"tooltips",flag:"_ecui_tips",offset:{x:0,y:0},tpl:'<div class="{prefix}-arrow {prefix}-arrow-top"><em></em><ins></ins></div><div class="{prefix}-title"></div><div class="{prefix}-body"></div>'},binds:"onResize, onShow, onHide, hide",init:function(t){t=this.setOptions(t),t.hideDelay=t.hideDelay||o.HIDE_DELAY,this.disabled=t.disabled,this.title=t.title,this.content=t.content;var e=t.prefix,i=this.main=document.createElement("div");i.className=e,i.innerHTML=t.tpl.replace(/{prefix}/g,e),i.style.left="-2000px",this.events={over:{on:"mouseenter",un:"mouseleave"},click:{on:"click",un:"click"}}[t.mode]},render:function(){var t=this,i=this.main,n=this.options,r=this.events;if(!this.rendered){this.rendered=!0,document.body.appendChild(i),e.on(i,"click",function(e){t.fire("click",{event:e})}),e.on(i,"mouseenter",function(){t.clear()}),e.on(i,"mouseleave",function(){t.clear(),t.timer=setTimeout(t.hide,n.hideDelay)});var s=this.elements={},o=n.prefix+"-";e.each("arrow,title,body".split(","),function(t){s[t]=e.q(o+t,i)[0]}),this.addTriggers(n.triggers)}return!r&&this.triggers&&this.show(this.triggers[0]),this},addTriggers:function(t){var i=this,n=this.options,r=this.events,s=n.flag;this.triggers="string"==typeof t?e.q(n.triggers):t.length?t:[t],r&&e.each(this.triggers,function(t){e.addClass(t,s),e.on(t,r.on,i.onShow),e.on(t,r.un,i.onHide)})},clear:function(){clearTimeout(this.timer),clearTimeout(this.resizeTimer)},onResize:function(){clearTimeout(this.resizeTimer);var t=this;this.resizeTimer=setTimeout(function(){t.show(t.current)},100)},onShow:function(t){var e=s(t,this.options.flag);this.clear(),e&&this.current!==e&&(this.current=e,this.fire("beforeShow",{target:e,event:t}),this.show(e))},onHide:function(){var t=this.options;this.clear(),t.hideDelay?this.timer=setTimeout(this.hide,t.hideDelay):this.hide()},show:function(t){var i=this.options,n=this.events,r=this.elements;this.clear(),this.current=t,n&&t&&e.on(t,n.un,this.onHide),e.on(window,"resize",this.onResize),r.title.innerHTML=this.title||"",r.body.innerHTML=this.content,e[this.title?"show":"hide"](r.title),i.arrow||e.hide(r.arrow),this.computePosition(),this.fire("show",{target:t})},hide:function(){var t=this.main;this.clear();var n=this.elements.arrow;i.setStyle(t,"left",-t.offsetWidth-n.offsetWidth),this.current=null,e.un(window,"resize",this.onResize),this.fire("hide")},isVisible:function(){return!!this.current},setTitle:function(t){this.title=t||"";var i=this.elements;i.title.innerHTML=this.title,e[this.title?"show":"hide"](i.title)},setContent:function(t){this.content=t||"",this.elements.body.innerHTML=this.content},computePosition:function(){var t=this.options,e=this.current,r=this.main,s=this.elements.arrow,o=t.arrow,l=i.getPosition(e),a=t.prefix+"-arrow",c=l.top,u=l.left,d=e.offsetWidth,h=e.offsetHeight,f=u+d,p=c+h,m=u+d/2,g=c+h/2,v=r.offsetWidth,b=r.offsetHeight,y=s.firstChild.offsetWidth,w=s.firstChild.offsetHeight,x=n.getScrollTop(),T=n.getScrollLeft(),C=T+n.getViewWidth(),E=x+n.getViewHeight(),_=e.getAttribute("data-tooltips");_&&(o=/[trblc]{2}/.test(_)?_:"1");var L,S;if(o&&"1"!==o)S=o.charAt(0),L=o.charAt(1);else{var D=d>v||u-(v-d)/2>0&&C>=f+(v-d)/2?"c":u+v>C?"r":"l",H=h>b||c-(b-h)/2>0&&E>=p+(b-h)/2?"c":c+b>E?"b":"t";E>=p+w+b?(S="b",L=D):C>=f+v+y?(S="r",L=H):c-b-w>=x?(S="t",L=D):u-v-y>=T&&(S="l",L=H),o=S+L}var A={l:"left",r:"right",t:"top",b:"bottom"},k=t.offset;s.className=a+" "+a+"-"+A[S],y=s.firstChild.offsetWidth,w=s.firstChild.offsetHeight;var z=(v-y)/2,B=(b-w)/2;({t:1,b:1})[S]?(u={l:u,c:m-v/2,r:f-v}[L],c={t:c-w-b-k.y,b:p+w+k.y}[S],i.setStyle(s,"left",{c:z,l:(d-y)/2,r:v-(d-y)/2}[d>v?"c":L]),i.setStyle(s,"top","")):{l:1,r:1}[S]&&(c={t:c,c:g-b/2,b:p-b}[L],u={l:u-y-v-k.x,r:f+y+k.x}[S],i.setStyle(s,"top",{c:B,t:(h-w)/2,b:b-(h-w)/2}[h>b?"c":L]),i.setStyle(s,"left","")),i.setStyles(r,{left:u,top:c})}},e.inherits(o,r),o}),define(["./tip"],function(t){function e(t,e){var i=parseInt(e.main.style.left,10),n=parseInt(e.elements.arrow.style.left,10),r=baidu.g(y.leftLimiteDomId),s=r?parseInt(baidu.dom.getPosition(r).left,10):i;e.main.style.left=s+"px",e.elements.arrow.style.left=i+n-s+"px"}function i(t,e){var i=parseInt(e.main.style.left,10),n=y.layerOffsetLeft||0;e.main.style.left=i-n+"px",e.elements.arrow.style.left=n+"px"}function n(t){var e=y.statistics;if(e&&e[t]&&e[t].url){var i=window.bds||{},n="";i&&i.comm&&i.comm.qid&&(n=i.comm.qid);var r={qid:n,url:window.document.location.href,timestamp:+new Date};w=e[t].url,baidu.object.extend(r,e[t].query||{}),x(r)}}function r(t,r){var s="bl",o=t.target.getAttribute("data-tooltips");o&&(s=/[trblc]{2}/.test(o)?o:"1"),"bc"===s&&e(t,r),"bl"===s&&i(t,r),(baidu.dom.hasClass(t.target,"icon-certify")||baidu.dom.hasClass(t.target,"icon-personal"))&&n("identity"),baidu.dom.hasClass(t.target,"icon-coupon")&&n("coupon"),baidu.dom.hasClass(t.target,"icon-tel")&&n("telephone")}function s(t,e){var i={},n="";if(t){var r=[];for(var s in t)"billing"!==s&&"url"!==s&&"text"!==s&&r.push("'"+s+"'"+":"+"'"+t[s]+"'");i={billing:t.billing&&' class="EC_PP"',url:t.url,text:t.text||e,options:r.join(",")},n=o("a",i)}return n}function o(t,e){return e=e||{},baidu.format(b[t],e)}function l(t,e){var i="";if(e){var n=s(e.a,"百度身份认证"),r=o("creditblock",{credit:e.credit});i=o(t,{text:e.text,a:n,creditblock:r,img:e.img})}return i}function a(t){var e=o("title",{title:t.title}),i=s(t.favorite,"收藏"),n=s(t.appraise,"评论"),r=o("rightTop",{favorite:i,appraise:n,and:i&&n&&"&nbsp|&nbsp"}),l=""+e+r;return l}function c(t){var e=l("medical",t.medical),i=l("identity",t.identity),n=l("personal",t.personal),r=l("airline",t.airline),a=l("dfa",t.dfa),c=o("list",{medical:e,identity:i,airline:r,dfa:a,personal:n}),u=s(t.report,"举报"),d=o("rightBottom",{report:u}),h=""+c+d;return h}function u(t){var e=o("title",{title:t.title});return e}function d(t){var e=o("telephone",{text:t.text});return e}function h(t){var e=o("title",{title:t.title});return e}function f(t){var e=s(t.a,"优惠券链接"),i=o("coupon",{a:e,text:t.text});return i}function p(t,e){var i=t.getAttribute(e);return i&&baidu.json.parse(i)}function m(t,e){var i="",n="",r=t.target;baidu.dom.addClass(e.main,"ecl-ui-tip-ps"),baidu.dom["true"===t.target.getAttribute("data-tip-limite")?"addClass":"removeClass"](e.main,"ecl-ui-tip-ps-limite-width");var s=p(r,"data-renzheng"),o=p(r,"data-telephone"),l=p(r,"data-coupon");s&&(i=a(s),n=c(s)),o&&(i=u(o),n=d(o)),l&&(i=h(l),n=f(l)),e.title=i,e.content=n}function g(t){var e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",t);var i=document.getElementsByTagName("head")[0]||document.body;i.appendChild(e),i=null,e=null}function v(e){var i="http://s1.bdstatic.com/r/www/cache/biz/ecom/common/api/tip0624/tipapi.css";g(i),baidu.object.extend(y,e||{}),new t({mode:"over",triggers:y.triggers,arrow:"bl",hideDelay:y.hideDelay,offset:{x:y.layerOffsetLeft,y:y.layerOffsetTop},onShow:function(t){r(t,this)},onBeforeShow:function(t){m(t,this)}}).render()}var b={a:'<span#{billing}><a target="_blank"  href="#{url}" onmousedown="return c({\'title\':this.innerHTML,\'url\':this.href,#{options}});">#{text}</a></span>',title:'<strong class="ecl-ui-tip-ps-title">#{title}</strong>',rightTop:'<div class="ecl-ui-tip-ps-right ecl-ui-tip-ps-right-top">#{favorite}#{and}#{appraise}</div>',telephone:'<div class="ecl-ui-tip-ps-telephone">#{text}</div>',coupon:'<div class="ecl-ui-tip-ps-coupon">#{text}#{a}</div>',list:"<ul>#{medical}#{airline}#{dfa}#{identity}#{personal}</ul>",medical:'<li class="icon-medical"><span>#{text}</span></li>',identity:'<li class="icon-identity">已经通过#{text}#{a}</li>#{creditblock}',personal:'<li class="icon-empty"><img height=16 width=16 src="#{img}">已经通过#{text}#{a}</li>#{creditblock}',creditblock:'<li class="icon-empty"><div class="ecl-ui-tip-ps-level ecl-ui-tip-ps-level#{credit}">百度信誉星级</div></li>',airline:'<li class="icon-empty"><img height=16 width=16 src="#{img}">具有#{a}的#{text}</li>',dfa:'<li class="icon-empty"><img height=16 width=16 src="#{img}">#{text}</li>',rightBottom:'<div class="ecl-ui-tip-ps-right ecl-ui-tip-ps-right-bottom">#{report}</div>'},y={triggers:"ec-ui-tip",leftLimiteDomId:"ec_im_container",layerOffsetLeft:5,layerOffsetTop:5,hideDelay:500},w="",x=function(){var t=[],e=function(t){return encodeURIComponent(t)};return function(i){var n=t.push(new Image)-1;t[n].onload=t[n].onerror=function(){t[n]=t[n].onload=t[n].onerror=null,delete t[n]};var r=w+"?"+baidu.url.jsonToQuery(i,e);t[n].src=r}}();return{init:v}});
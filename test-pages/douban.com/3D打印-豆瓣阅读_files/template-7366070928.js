define("mod/template",["mod/lang"],function(_){_=_||Ark._;var escapes={"\\":"\\","'":"'",r:"\r",n:"\n",t:"	",u2028:"\u2028",u2029:"\u2029"};for(var p in escapes)escapes[escapes[p]]=p;var escaper=/\\|'|\r|\n|\t|\u2028|\u2029/g,unescaper=/\\(\\|'|r|n|t|u2028|u2029)/g,unescape=function(code){return code.replace(unescaper,function(match,escape){return escapes[escape]})},template=function(text,data,settings){settings=_.extend(settings||{},{evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,escape:/\{\{-([\s\S]+?)\}\}/g});var source="__p+='"+text.replace(escaper,function(match){return"\\"+escapes[match]}).replace(settings.escape,function(match,code){return"'+\n_.escape("+unescape(code)+")+\n'"}).replace(settings.interpolate,function(match,code){return"'+\n("+unescape(code)+")+\n'"}).replace(settings.evaluate,function(match,code){return"';\n"+unescape(code)+"\n;__p+='"})+"';\n";settings.variable||(source="with(obj||{}){\n"+source+"}\n"),source="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+source+"return __p;\n";var render=Function(settings.variable||"obj","_",source);if(data)return render(data,_);var tmpl=function(data){return render.call(this,data,_)};return tmpl.source="function("+(settings.variable||"obj")+"){\n"+source+"}",tmpl};return template});
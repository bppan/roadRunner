define("mod/ajax",["jquery","mod/cookie"],function($,cookie){function ajax(){var args=arguments,options=args[args.length-1]||{};if(options.arkWithDocReferer&&cookie("prev_referer",document.referrer,{path:"/","max-age":2}),options.type&&"GET"!==options.type.toUpperCase()&&(options.data=$.extend({},options.data,{ck:cookie("ck")})),cookie("profile")){var userFilter=null;$.each(options,function(key,val){"dataFilter"===key&&(userFilter=val,delete args[key])}),options=$.extend(options,{dataFilter:function(data){try{data=$.parseJSON(data)}catch(e){data=data}return require("widget/profile",function(profile){profile=profile||Ark.profile,profile.add({time:data.pt,uri:data.uri,type:options.type,stdout:data.profile})}),null===userFilter?data.rawData:userFilter(data.rawData)}})}return $.ajax.apply($,args)}return ajax.post=function(url,data,callback,dataType){return $.isFunction(data)&&(dataType=dataType||callback,callback=data,data=void 0),ajax(url,{type:"POST",data:data,success:callback,dataType:dataType||"json"})},ajax.get=function(url,callback,dataType){return ajax(url,{type:"GET",success:callback,dataType:dataType||"json"})},ajax.methodMap={read:"GET",create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE"},ajax.request=function(method,url,data,options,dataType){return $.isFunction(data)&&(dataType=options,options=data,data={}),ajax(url,$.extend({type:method,data:data,dataType:dataType||"text"},options))},ajax});
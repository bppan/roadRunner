define("ui/overlay",["jquery","mod/emitter"],function($,Emitter){function Overlay(opts){Emitter.call(this);var self=this;this.opts=opts,this.el=$(tmpl).appendTo("body"),this.anchor=$("<div>",{id:"k-anchor"}).prependTo("body"),this.body=this.el.find(".k-slave"),this.closable=void 0!==opts.closable?!!opts.closable:!0,this.setBody(),this.closable&&doc.on("click.close","#ark-overlay",function(e){e.target===e.currentTarget&&self.close()}).on("keyup.close",function(e){/input|textarea/i.test(e.target.tagName)||27!==e.keyCode||self.close()})}function exports(opts){return opts=opts||{},new exports.Overlay(opts)}var tmpl='<div id="ark-overlay" class="hide"><div class="k-stick"></div><div class="k-content"><div class="k-slave"></div></div></div>',doc=$(document),docRoot=$("html");return $.extend(Overlay.prototype,{close:function(){return docRoot.removeClass("ark-overlay"),this.el.remove(),this.anchor.remove(),doc.scrollTop(this.scrollTop),doc.off(".close"),this.emit("close"),this},open:function(){return this.scrollTop=doc.scrollTop(),this.anchor.css("margin-top",-this.scrollTop),docRoot.addClass("ark-overlay"),this.el.removeClass("hide"),this.emit("open"),this},setBody:function(body){return body=body||this.opts.body,this.body.html(body),this}}),Emitter(Overlay.prototype),exports.Overlay=Overlay,exports});